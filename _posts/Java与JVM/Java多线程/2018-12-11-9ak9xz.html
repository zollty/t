---
layout: post
publishTime: 2018-12-11
category: Java与JVM
tags: [Java多线程]
---

<div style="border:1px solid #3c763d; padding:0 8px; margin:0 -8px;" onclick="$('#59kyae').fadeToggle(100);"><p><strong>题干=</strong></p><p>什么是线程安全性？</p></div><div id="59kyae" style="display:none;border:1px solid #317090; border-top-color:#aabaaa; padding:0 8px; margin:0 -4px;"><p><strong>答案=</strong></p><p>&nbsp; &nbsp; 当多个线程访问某个类时，不管运行时环境采用何种调度方式或者这些线程将如何交替执行，并且在主调代码中不需要任何额外的同步或协同，这个类都能表现出正确的行为，那么就称这个类是线程安全的。</p><p>&nbsp; &nbsp; 无状态对象（StatelessFactorizer）是线程安全的：因为它既不包含任何域，也不包含任何对其他类中域的引用。计算过程中的临时状态仅存在于线程栈上的局部变量中，并且只能由正在执行的线程访问。访问StatelessFactorizer的线程不会影响另一个访问同一个StatelessFactorizer的线程的计算结果，因为这两个线程并没有共享状态，就好像它们都在访问不同的实例。</p><p style='line-height: 1;'><br/></p></div><div style="border:1px solid #3c763d; padding:0 8px; margin:0 -8px;" onclick="$('#vczeu3').fadeToggle(100);"><p><strong>题干=</strong></p><p>Java线程和操作系统线程的关系是什么？</p></div><div id="vczeu3" style="display:none;border:1px solid #317090; border-top-color:#aabaaa; padding:0 8px; margin:0 -4px;"><p><strong>答案=</strong></p><p>&nbsp; &nbsp; In the Hotspot JVM there is a direct mapping between a Java Thread and a native operating system Thread（直接映射关系，一对一）. After preparing all of the state for a Java thread such as thread-local storage, allocation buffers, synchronization objects, stacks and the program counter, the native thread is created. The native thread is reclaimed(回收) once the Java thread terminates. The operating system is therefore responsible for scheduling all threads and dispatching them to any available CPU. Once the native thread has initialized it invokes the run() method in the Java thread（一旦本地线程完成初始化，就会调用Java线程的run()方法）. When the run() method returns, uncaught exceptions are handled, then the native thread confirms if the JVM needs to be terminated as a result of the thread terminating (i.e. is it the last non-deamon thread). When the thread terminates all resources for both the native and Java thread are released.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;参考资料来源于 一位绝对的Java大神：<a href="http://blog.jamesdbloom.com/JVMInternals.html" target="_blank">JVMInternals</a> </p><p style='line-height: 1;'><br/></p></div><div style="border:1px solid #3c763d; padding:0 8px; margin:0 -8px;" onclick="$('#de9z3x').fadeToggle(100);"><p><strong>题干=</strong></p><p>Hotspot JVM有哪些系统线程（JVM System Threads）？</p></div><div id="de9z3x" style="display:none;border:1px solid #317090; border-top-color:#aabaaa; padding:0 8px; margin:0 -4px;"><p><strong>答案=</strong></p><p>有5个，如下：</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p>VM thread</p></li><li><p>Periodic task thread</p></li><li><p>GC threads</p></li><li><p>Compiler threads</p></li><li><p>Signal dispatcher thread</p></li></ul><p style='line-height: 1;'><br/></p><p>相关说明：</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p><strong>VM thread</strong></p></li></ul><p>&nbsp;&nbsp;&nbsp;&nbsp;This thread waits for operations to appear that require the JVM to reach a safe-point（该线程用于等待让JVM达到安全点的操作出现，即准备关闭JVM的操作）. The reason these operations have to happen on a separate thread is because they all require the JVM to be at a safe point where modifications to the heap can not occur（之所以要单独出来，是因为这些关闭JVM的操作必须 要求JVM处于一个不能修改堆的“安全点”）.The type of operations performed by this thread are &quot;stop-the-world&quot; garbage collections, thread stack dumps, thread suspension and biased locking revocation（此线程执行的操作类型包括“stop the world”垃圾收集、线程堆栈dump、线程挂起和偏向锁吊销）.</p><p style='line-height: 1;'><br/></p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p><strong>Periodic task thread</strong></p></li></ul><p>&nbsp;&nbsp; &nbsp;This thread is responsible for timer events (i.e. interrupts) that are used to schedule execution of periodic operations &nbsp; &nbsp;</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p><strong>GC threads</strong></p></li></ul><p>&nbsp;&nbsp; &nbsp;These threads support the different types of garbage collection activities that occur in the JVM &nbsp; &nbsp;</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p><strong>Compiler threads</strong></p></li></ul><p>&nbsp;&nbsp; &nbsp;These threads compile byte code to native code at runtime &nbsp; &nbsp;</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p><strong>Signal dispatcher thread</strong></p></li></ul><p>&nbsp;&nbsp; &nbsp;This thread receives signals sent to the JVM process and handle them inside the JVM by calling the appropriate JVM methods. &nbsp; &nbsp;</p><p style='line-height: 1;'><br/></p><p style='line-height: 1;'><br/></p></div>